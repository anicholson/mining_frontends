#!/usr/bin/env ruby
# encoding: utf-8
# rubocop:disable AndOr

$LOAD_PATH.unshift File.expand_path('../../lib', __FILE__)

require 'bundler/setup'
require 'curses'
require 'mining_depot'
require 'pry'
require 'helpers'

include Curses

_, height, width = init_world!

start_color
init_screen

EMPTY = COLOR_WHITE
init_pair(COLOR_BLUE, COLOR_BLUE, COLOR_BLACK)
init_pair(EMPTY, EMPTY, COLOR_BLACK)

win = world_window(height, width)

begin
  noecho
  crmode
  loop do
    update = GetWorldView.run

    draw_screen(win, update.result) if update.success?

    win.refresh
    sleep 1
  end
ensure
  close_screen
end
